{% extends "base.html" %}
{% block content %}
<h2 class="mb-4">Your Orders</h2>

{% if messages %}
  {% for m in messages %}
    <div class="alert alert-{{ m.tags|default:'info' }}">{{ m }}</div>
  {% endfor %}
{% endif %}

{% if orders %}
  {% for order in orders %}
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <!-- Order header -->
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="fw-semibold">Order #{{ order.id }}</div>
          <div class="small text-muted">{{ order.created_at|date:"j M Y, H:i" }}</div>
        </div>

        <hr class="my-2">

        <!-- Items list -->
        <ul class="list-unstyled mb-3">
          {% for item in order.items.all %}
            <li class="d-flex justify-content-between py-1">
              <span>{{ item.title }} × {{ item.qty }}</span>
              <span>₹ {{ item.price_snapshot }}</span>
            </li>
          {% endfor %}
        </ul>

        <!-- Total + actions -->
        <div class="d-flex justify-content-between align-items-center">
          <a href="{% url 'market:order_detail' pk=order.id %}" class="btn btn-sm btn-outline-primary">
            View Details
          </a>
          <div class="fw-bold">Total: ₹ {{ order.total_amount }}</div>
        </div>
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-info">No previous purchases found.</div>
  <a href="{% url 'market:product_list' %}" class="btn btn-primary mt-2">Browse Products</a>
{% endif %}

<!-- Inline page-specific styling -->
<style>
  .card {
    border: 1px solid rgba(15,118,110,0.05);
    border-radius: 12px;
    background: #fff;
    box-shadow: 0 6px 18px rgba(13, 38, 59, 0.04);
  }
  .btn-primary {
    background: linear-gradient(90deg, #0f766e, #06b6d4);
    border: none;
  }
  .btn-outline-primary {
    border-color: rgba(15,118,110,0.3);
    color: #0f766e;
  }
  .btn-outline-primary:hover {
    background: #0f766e;
    color: #fff;
  }
</style>
{% endblock %}
